<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uma Musume Hidden Factors Tracker</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ‡ Uma Musume Hidden Factors Tracker</h1>
            <h2 style="margin-top: -10px; margin-bottom: 10px; color: rgba(255,255,255,0.9); font-size: 1.4rem;">ã‚¦ãƒå¨˜ éš ã—å› å­ãƒˆãƒ©ãƒƒã‚«ãƒ¼</h2>
            <div class="subtitle">Track your race progress and unlock hidden factors</div>
            <div class="subtitle" style="margin-top: 5px; font-size: 1rem;">ãƒ¬ãƒ¼ã‚¹é€²æ—ã‚’è¿½è·¡ã—ã¦éš ã—å› å­ã‚’è§£æ”¾ã—ã‚ˆã†</div>
        </header>

        <div class="main-content">
            <div class="races-section" id="planner-section">
                <h2 class="section-title">Race Planner<br><span style="font-size: 0.8em; font-weight: normal; color: #718096;">ãƒ¬ãƒ¼ã‚¹ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ï¼ˆã‚²ãƒ¼ãƒ é¢¨UIï¼‰</span></h2>
                <div class="year-tabs">
                    <button class="year-tab active" id="tab-junior" onclick="tracker.setPlannerYear('junior')">ã‚¸ãƒ¥ãƒ‹ã‚¢ç´š<br><span style="font-size: 0.8em; font-weight:600;">Junior</span></button>
                    <button class="year-tab" id="tab-classics" onclick="tracker.setPlannerYear('classics')">ã‚¯ãƒ©ã‚·ãƒƒã‚¯ç´š<br><span style="font-size: 0.8em; font-weight:600;">Classic</span></button>
                    <button class="year-tab" id="tab-senior" onclick="tracker.setPlannerYear('senior')">ã‚·ãƒ‹ã‚¢ç´š<br><span style="font-size: 0.8em; font-weight:600;">Senior</span></button>
                    <div style="margin-left:auto; display:flex; gap:8px;">
                        <button class="filter-btn" onclick="tracker.clearPlannerYear()">ã“ã®ãƒšãƒ¼ã‚¸ã‚’ãƒªã‚»ãƒƒãƒˆ<br><span style="font-size: 0.8em; font-weight:600;">Reset this page</span></button>
                </div>
                </div>
                <div class="planner-grid" id="planner-grid"></div>
            </div>

            <div class="progress-section" id="progress-panel">
                <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px; gap: 10px;">
                    <h2 class="section-title" style="margin-bottom: 0; flex: 1;">Progress Tracker<br><span style="font-size: 0.8em; font-weight: normal; color: #718096;">é€²æ—ãƒˆãƒ©ãƒƒã‚«ãƒ¼</span></h2>
                    <button class="btn btn-clear-tracking" id="clear-tracking-btn" onclick="tracker.clearTrackedFactor()" style="display: none;" title="Clear tracking / è¿½è·¡è§£é™¤">
                        âœ– Clear<br><span style="font-size: 0.7em;">è¿½è·¡è§£é™¤</span>
                    </button>
                </div>
                
                <div class="stats">
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-number" id="total-races">0</div>
                            <div class="stat-label">Races Run<br><span style="font-size: 0.7em;">å‡ºèµ°å›æ•°</span></div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="total-wins">0</div>
                            <div class="stat-label">Wins<br><span style="font-size: 0.7em;">å‹åˆ©æ•°</span></div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="total-losses">0</div>
                            <div class="stat-label">Losses<br><span style="font-size: 0.7em;">æ•—åŒ—æ•°</span></div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="completed-factors">0</div>
                            <div class="stat-label">Factors<br><span style="font-size: 0.7em;">å› å­æ•°</span></div>
                        </div>
                    </div>
                </div>

                <div class="hidden-factors" id="hidden-factors">
                    <!-- Hidden factors will be populated here -->
                </div>
            </div>
        </div>

        <!-- Full-width calendar placed at bottom -->
        <div style="max-width: 1400px; margin: 18px auto 0 auto;">
            <div class="races-section" id="calendar-section" style="padding: 18px;">
                <h2 class="section-title">Race Database<br><span style="font-size: 0.8em; font-weight: normal; color: #718096;">ãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</span></h2>
                <div class="controls">
                    <button class="filter-btn active" data-filter="all">All Races<br><span style="font-size: 0.7em;">å…¨ãƒ¬ãƒ¼ã‚¹</span></button>
                    <button class="filter-btn" data-filter="GI">G1</button>
                    <button class="filter-btn" data-filter="GII">G2</button>
                    <button class="filter-btn" data-filter="GIII">G3</button>
                    <button class="filter-btn" data-filter="Open">OP</button>
                    <button class="filter-btn" data-filter="Pre-OP">Pre-OP</button>                   
                    <button class="filter-btn" data-filter="junior">Junior Year<br><span style="font-size: 0.7em;">ã‚¸ãƒ¥ãƒ‹ã‚¢ç´š</span></button>
                    <button class="filter-btn" data-filter="classic">Classic Year<br><span style="font-size: 0.7em;">ã‚¯ãƒ©ã‚·ãƒƒã‚¯ç´š</span></button>
                    <button class="filter-btn" data-filter="senior">Senior Year<br><span style="font-size: 0.7em;">ã‚·ãƒ‹ã‚¢ç´š</span></button>
                    <button class="filter-btn" data-filter="SSS">Summer Sprint<br><span style="font-size: 0.7em;">ã‚µãƒãƒ¼ã‚¹ãƒ—ãƒªãƒ³ãƒˆ</span></button>
                    <button class="filter-btn" data-filter="SMS">Summer Mile<br><span style="font-size: 0.7em;">ã‚µãƒãƒ¼ãƒã‚¤ãƒ«</span></button>
                    <button class="filter-btn" data-filter="S2000">Summer 2000<br><span style="font-size: 0.7em;">ã‚µãƒãƒ¼2000</span></button>
                    <button class="filter-btn" data-filter="selected">Selected<br><span style="font-size: 0.7em;">é¸æŠæ¸ˆã¿</span></button>
                    <button class="filter-btn" id="tracked-filter-btn" data-filter="tracked" style="display: none;">ğŸ” Tracked<br><span style="font-size: 0.7em;">è¿½è·¡ä¸­</span></button>
                    <button class="filter-btn" onclick="tracker.clearAll()" style="background: #e53e3e; color: white; border-color: #e53e3e;">Clear All<br><span style="font-size: 0.7em;">å…¨è§£é™¤</span></button>
                </div>
                <div class="races-grid" id="races-grid"></div>
                <div style="margin-top: 12px; font-size: 0.8rem; color: #718096;"><span id="data-source-indicator"></span></div>
            </div>
        </div>
    </div>

    <script src="races.js"></script>
    <script src="app.js"></script>

    <!-- Picker Modal -->
    <div id="picker-modal" class="picker-modal hidden">
        <div class="picker-backdrop" onclick="tracker.closePicker()"></div>
        <button class="picker-nav picker-nav-left" onclick="tracker.navigatePicker(-1)" aria-label="Previous">â€¹</button>
        <button class="picker-nav picker-nav-right" onclick="tracker.navigatePicker(1)" aria-label="Next">â€º</button>
        <div class="picker-panel" id="picker-panel">
            <div class="picker-head">
                <div class="picker-title" id="picker-title">ãƒ¬ãƒ¼ã‚¹é¸æŠ</div>
                <div style="display: flex; gap: 8px;">
                    <button class="btn btn-secondary toggle-close-on-selection" id="toggle-close-btn" onclick="tracker.toggleCloseOnSelection()" title="Toggle close on selection">
                        <span class="toggle-icon"></span>
                        <div class="toggle-text">
                            <div class="toggle-text-en">Auto-close</div>
                            <div class="toggle-text-jp">è‡ªå‹•é–‰ã˜ã‚‹</div>
                        </div>
                    </button>
                </div>
            </div>
            <div class="picker-body">
                <div id="picker-list" class="picker-list"></div>
            </div>
            <div class="picker-actions">
                <button class="btn btn-primary" onclick="tracker.closePicker()">å®Œäº†</button>
            </div>
        </div>
    </div>
</body>
</html>
